# ICS Toolkit Configuration
# Copy to config.yaml and adjust for your environment.

# Append pipeline settings (organize, merge, match)
append:
  base_dir: ~/Desktop/ICS_Files
  # ars_dir: ~/Desktop/ARS_Files       # optional
  output_dir: output/
  match_month: "2026.01"                # YYYY.MM format
  dry_run: false
  overwrite: true
  csv_copy: false
  default_ref_keywords:
    - referral
    - ref
    - ics_detailed
  default_dm_keywords:
    - direct mail
    - directmail
    - new accounts
  hash_min_length: 6
  match_rate_warn_threshold: 0.5

  # Per-client overrides (keyed by client ID)
  # clients:
  #   "1453":
  #     ref_column: "Account Number"
  #     ref_header_row: 0
  #     dm_column: "Acct #"
  #     dm_header_row: 1

# Analysis pipeline settings
analysis:
  data_file: data/9999-ref.xlsx
  client_id: "9999"
  client_name: "Sample Credit Union"
  output_dir: output/
  # cohort_start: "2024-01"             # null = auto-detect from data
  ics_not_in_dump: 0

  # Master client config file (auto-loads stat codes, branch names, etc.)
  # Resolution: client_config_path > ICS_CLIENT_CONFIG env var > M drive default
  # client_config_path: "M:/ICS/Config/clients_config.json"

  # Per-client overrides (keyed by client ID from filename)
  # These override master config values. Stat codes default to O=open, C=closed.
  clients:
    "1759":
      open_stat_codes: ["A"]
      # interchange_rate: 0.0195
      # branch_mapping:
      #   "01": "Main Office"
      #   "02": "North Branch"
      # prod_code_mapping:
      #   "100": "Regular Checking"
      #   "200": "Savings"
  #   "1776":                             # uses defaults or master config

  balance_tiers:
    bins: [-.inf, 0, 1000, 5000, 10000, 25000, 50000, 100000, .inf]
    labels:
      - "$0 or Less"
      - "$0-$1K"
      - "$1K-$5K"
      - "$5K-$10K"
      - "$10K-$25K"
      - "$25K-$50K"
      - "$50K-$100K"
      - "$100K+"

  age_ranges:
    bins: [0, 30, 90, 180, 365, 730, 1825, 3650, .inf]
    labels:
      - "0-1 month"
      - "1-3 months"
      - "3-6 months"
      - "6-12 months"
      - "1-2 years"
      - "2-5 years"
      - "5-10 years"
      - "10+ years"

  outputs:
    excel: true
    powerpoint: true
    html_charts: false

  charts:
    theme: plotly_white
    colors: ["#1B365D", "#4A90D9", "#7BC67E", "#F5A623", "#D0021B", "#8B572A"]
    width: 900
    height: 500
    scale: 3

  # pptx_template: templates/ics_template.pptx

# Referral intelligence pipeline settings
referral:
  data_file: data/1776_ics_detailed_referral_v9_PTD.xls
  client_id: "1776"
  client_name: "Sample Credit Union"
  output_dir: output/referral/
  header_row: 0

  # Influence scoring weights (must sum to 1.0)
  scoring_weights:
    unique_accounts: 0.35
    burst_count: 0.25
    channels_used: 0.20
    velocity: 0.10
    longevity: 0.10

  # Staff multiplier weights (must sum to 1.0)
  staff_weights:
    avg_referrer_score: 0.60
    unique_referrers: 0.40

  # Thresholds
  burst_window_days: 14
  dormancy_days: 180
  high_value_min_referrals: 5
  emerging_min_burst_count: 2
  emerging_lookback_days: 180
  top_n_referrers: 25

  # Entity normalization aliases (merge misspellings/variants)
  # name_aliases:
  #   "JOHN SMYTH": "JOHN SMITH"
  #   "J SMITH": "JOHN SMITH"

  # Branch label mapping
  # branch_mapping:
  #   "001": "Main Office"
  #   "002": "North Branch"

  # Referral code prefix -> channel classification
  code_prefix_map:
    "150A": "BRANCH_STANDARD"
    "120A": "BRANCH_STANDARD"
    "080A": "BRANCH_STANDARD"
    "100A": "BRANCH_STANDARD"
    "030A": "BRANCH_STANDARD"
    "020A": "BRANCH_STANDARD"
    "PC": "DIGITAL_PROCESS"
    "EMAIL": "EMAIL"

  outputs:
    excel: true
    powerpoint: true
    html_charts: false

  charts:
    theme: plotly_white
    colors: ["#1B365D", "#4A90D9", "#7BC67E", "#F5A623", "#D0021B", "#8B572A"]
    width: 900
    height: 500
    scale: 3

  # pptx_template: templates/referral_template.pptx
